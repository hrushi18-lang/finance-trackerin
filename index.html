<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <!-- Font preloading for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Load Google Fonts with mobile optimization and fallback -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700&family=Archivo+Black:wght@400&family=Playfair+Display:wght@400;500;600;700&display=swap&subset=latin" as="style" onload="this.onload=null;this.rel='stylesheet'" onerror="this.onload=null;this.rel='stylesheet';document.body.classList.add('fonts-fallback');">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700&family=Archivo+Black:wght@400&family=Playfair+Display:wght@400;500;600;700&display=swap&subset=latin" rel="stylesheet"></noscript>
    
    <!-- Enhanced fallback font loading with CSP error handling -->
    <script>
      // Enhanced fallback font loading with error handling
      function loadGoogleFonts() {
        try {
          // Check if fonts are already loaded
          if (document.querySelector('link[href*="fonts.googleapis.com"]')) {
            return;
          }
          
          // Create and append font link
          const link = document.createElement('link');
          link.href = 'https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700&family=Archivo+Black:wght@400&family=Playfair+Display:wght@400;500;600;700&display=swap&subset=latin';
          link.rel = 'stylesheet';
          link.crossOrigin = 'anonymous';
          
          // Add error handling
          link.onerror = function() {
            console.warn('Google Fonts failed to load, using system fonts');
            document.body.classList.add('fonts-fallback');
          };
          
          link.onload = function() {
            document.body.classList.add('fonts-loaded');
          };
          
          document.head.appendChild(link);
        } catch (error) {
          console.warn('Failed to load Google Fonts:', error);
          document.body.classList.add('fonts-fallback');
        }
      }
      
      // Load fonts after DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadGoogleFonts);
      } else {
        loadGoogleFonts();
      }
    </script>
    
    <!-- Mobile-first font optimization -->
    <style>
      /* Mobile-first font system with immediate fallbacks */
      :root {
        --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-numbers: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-description: 'Times New Roman', 'Times', serif;
      }
      
      /* Apply custom fonts when loaded */
      .fonts-loaded {
        --font-primary: 'Archivo', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-heading: 'Archivo Black', 'Archivo', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-numbers: 'Archivo', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-description: 'Playfair Display', 'Times New Roman', 'Times', serif;
      }
      
      /* Fallback fonts when Google Fonts fail to load */
      .fonts-fallback {
        --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-numbers: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        --font-description: 'Times New Roman', 'Times', serif;
      }
      
      /* Base font styles */
      body {
        font-family: var(--font-primary);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
        font-size: 16px;
        line-height: 1.5;
      }
      
      /* Mobile-specific optimizations */
      @media screen and (max-width: 768px) {
        body {
          font-size: 16px;
          line-height: 1.5;
          -webkit-text-size-adjust: 100%;
          text-size-adjust: 100%;
        }
        
        /* Ensure all text is visible on mobile */
        * {
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
        }
        
        /* Force system fonts for critical mobile elements */
        .mobile-critical {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;
        }
      }
      
      /* Font loading states */
      .fonts-loading {
        font-family: var(--font-primary);
      }
      
      .fonts-loaded {
        font-family: var(--font-primary);
      }
      
      /* Ensure text is always visible */
      .text-visible {
        color: #000 !important;
        opacity: 1 !important;
        visibility: visible !important;
      }
      
      /* Dark mode text visibility */
      @media (prefers-color-scheme: dark) {
        .text-visible {
          color: #fff !important;
        }
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com; style-src-elem 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com; font-src 'self' https://fonts.gstatic.com data:; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://api.exchangerate-api.com https://api.fixer.io https://www.googletagmanager.com https://fonts.googleapis.com https://fonts.gstatic.com; img-src 'self' data: https:; script-src 'self' 'unsafe-eval' 'unsafe-inline' https://www.googletagmanager.com; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';">
    <title>FinTrack - Smart Financial Management</title>
    <meta name="description" content="Comprehensive financial management with multi-account tracking, smart recurring transactions, and AI-powered insights">
    <meta name="theme-color" content="#2563eb">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  </head>
  <body class="text-slate-800" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #e2e8f0 100%);">
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>